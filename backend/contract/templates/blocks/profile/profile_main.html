{% extends "base.html" %}
{% block content %}
{% load django_bootstrap5 %}
{% load static %}

<div class="container">
    <div class="shop_main user-profile profile-header">
        <div class="shop_panel">
            <h1 class="settings-title">Настройки профиля</h1>
            <div class="settings-main">
                <div class="settings-main__content">
                    <div class="settings-main__info">
                        <div class="form-sm">

                            <form action="" method="post" enctype="multipart/form-data" novalidate="">
                                {% csrf_token %}
                                <div class="d-flex mt-3">


                                    <label class="mr-5" for="id_photo">
                                        {% if user.photo %}
                                        <div class="shop_panel_img">
                                            <img src="/media/{{ user.photo.photo }}" loading="lazy" id="profilePhoto">
                                        </div>
                                        {% else %}
                                        <div class="shop_panel_img ">
                                            <img src="{% static 'contract/img/icons/no-photo.svg' %}" loading="lazy" id="profilePhoto">
                                        </div>
                                        {% endif %}

                                    </label>
                                    <p class="profile-user-name">
                                        {{ user.login }}
                                    </p>
                                </div>
                                <div class="d-flex mt-3">
                                    <div style="flex:1;">
                                        <p>Статус поиска</p>
                                    </div>
                                    <div>
                                        <div>
                                            <label class="form-label">Статус поиска</label>
                                            <label class="form-check-label" for="id_is_active_0">
                                                <input class="form-check-input" type="radio" name="is_active" id="id_is_active_0" value="False">
                                                Пассивный</label>
                                        </div>
                                        <div>

                                            <label class="form-check-label" for="id_is_active_1">
                                                <input class="form-check-input" type="radio" name="is_active" id="id_is_active_1" value="True" checked="checked">
                                                Активный</label>
                                        </div>

                                    </div>
                                </div>


                                <input type="submit" class="btn btn-primary w-100 mt-3" value="Обновить">
                                <input type="file" name="photo" accept="image/*" class="vis-none" id="id_photo" onchange="readURL(this);">
                            </form>
                        </div>
                        <div class="form-md">
                            <form action="/profile/change_password" method="post" novalidate>
                                {% csrf_token %}
                                <div class="d-flex mt-3">
                                    <div style="flex:1;">
                                        <p class="bold">Изменить пароль</p>
                                    </div>
                                    <div class="">
                                        {% for field in change_pass_form.visible_fields %}
                                        <div>
                                            {{ field.errors }}
                                            {{ field }}
                                            {{ field.help_text }}
                                        </div>
                                        {% endfor %}
                                        {% if messages %}
                                        <ul class="messages">
                                            {% for message in messages %}
                                            <li {% if message.tags %} class="{{ message.tags }}" {% endif %}>
                                                {{ message }}</li>
                                            {% endfor %}
                                        </ul>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="form-sm">
                                    <input type="submit" class="btn btn-primary w-100" value="Обновить" />
                                </div>
                            </form>
                            <h3>Код восстановления, сохраните его для восстановления пароля</h3>
                            <textarea class="form-control" disabled>{{recovery_code}}</textarea>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>
<script>
    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function(e) {
                $('#profilePhoto').attr('src', e.target.result).width(90).height(90);
            };

            reader.readAsDataURL(input.files[0]);
        }
    }
</script>

{% endblock content %}