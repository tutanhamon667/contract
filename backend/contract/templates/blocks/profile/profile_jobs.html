{% extends "profile.html" %}
{% block profile_content %}
    {% load django_bootstrap5 %}
    <h1 class="my_order_title">Мои Вакансии</h1>
    <a href="/profile/jobs/create" class="btn btn-success">Создать вакансию</a>
    <div class="list-group">
        <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
            <form class="profile_jobs_filter_form" action="" method="get">
                <input type="hidden" name="status" value="{{ request.GET.status }}"/>
                <input type="hidden" name="page" value="{{ request.GET.page }}"/>
            </form>
            <input type="radio" class="btn-check" name="status_radio" id="status_0" autocomplete="off"
                    {% if request.GET.status == "0" %}
                   checked
                    {% endif %}
            >
            <label class="btn btn-outline-primary" for="status_0">Активные</label>

            <input type="radio" class="btn-check" name="status_radio" id="status_1" autocomplete="off"
                    {% if request.GET.status == "1" %}
                   checked
                    {% endif %}
            >
            <label class="btn btn-outline-primary" for="status_1">Ожидают оплаты</label>

        </div>
        {% if request.GET.status == "0" %}
            <table class="table">
                <thead>
                <tr>
                    <th scope="col">Название вакансия</th>
                    <th scope="col">Тип занятости</th>
                    <th scope="col">Просмотры</th>
                    <th scope="col">Отклики</th>
                    <th scope="col">Истекает</th>
                    <th scope="col"></th>
                    <th scope="col"></th>
                    <th scope="col"></th>
                </tr>
                </thead>
                <tbody>
                {% for job in jobs_paid %}
                    <tr>
                        <td>
                            <p>{{ job.title }}</p>
                            <p class="text-shadow">{{ job.tier_name }}</p>
                        </td>
                        <td>
                            {% if job.is_offline %}
                                <p>Оффлайн</p>
                            {% else %}
                                <p>Онлайн</p>
                            {% endif %}
                        </td>
                        <td>{{ job.views }}</td>
                        <td>{{ job.responses_count }}</td>
                        <td>{{ job.payment_expire }}</td>
                        <td><a href="{% url 'profile_job_view_pay_for_tier' job.id %}" class="btn-success">Сменить тариф </a></td>
                        <td><a href="/profile/jobs/update/{{ job.id }}" class="btn-success">Редактировать</a></td>
                        <td>
                            <form action="{% url 'profile_job_view_delete' %}" method="POST">
                                {% csrf_token %}
                                <input type="hidden" name="job_id" value="{{ job.id }}"/>
                                <input type="hidden" name="redirect" value="{{ request.get_full_path }}"/>
                                <input type="submit" class="btn btn-danger" value="удалить"/>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% endif %}
        {% if request.GET.status == "1" %}
            <table class="table">
                <thead>
                <tr>
                    <th scope="col">Название вакансия</th>
                    <th scope="col">Тип занятости</th>
                    <th scope="col">Просмотры</th>
                    <th scope="col">Отклики</th>
                    <th scope="col"></th>
                    <th scope="col"></th>
                    <th scope="col"></th>
                    <th scope="col"></th>
                </tr>
                </thead>
                <tbody>
                {% for job in jobs_not_paid %}
                    <tr>
                        <td>
                            <p>{{ job.title }}</p>
                            <p class="text-shadow">{{ job.tier_name }}</p>
                        </td>
                        <td>
                            {% if job.is_offline %}
                                <p>Оффлайн</p>
                            {% else %}
                                <p>Онлайн</p>
                            {% endif %}
                        </td>
                        <td>{{ job.views }}</td>
                        <td>{{ job.responses_count }}</td>
                        <td></td>
                        <td><a href="{% url 'profile_job_view_pay_for_tier' job.id %}" class="btn-success">Выбрать тариф и оплатить</a></td>
                        <td><a href="/profile/jobs/update/{{ job.id }}" class="btn-success">Редактировать</a></td>
                        <td>
                            <form action="{% url 'profile_job_view_delete' %}" method="POST">
                                {% csrf_token %}
                                <input type="hidden" name="job_id" value="{{ job.id }}"/>
                                <input type="hidden" name="redirect" value="{{ request.get_full_path }}"/>
                                <input type="submit" class="btn btn-danger" value="удалить"/>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% endif %}
        <script>
        $(document).ready(function () {
            const application = new app()
            application.profileJobsFilters()
        });
    </script>
    </div>

{% endblock profile_content %}